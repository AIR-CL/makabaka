<!DOCTYPE html><html lang="zh-CN">
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;" name="viewport" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title>用户资料 - 会员中心 -哈哩哈哩</title><!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js"></script><![endif]-->
    <script src="../resources/bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>
    <script src="../resources/bootstrap-3.3.7-dist/js/jquery-1.9.1.min.js"></script>
    <link rel="stylesheet" href="../resources/bootstrap-3.3.7-dist/css/bootstrap.min.css">
    <link href="../resources/tpl/zanpiancms/js/swiper.min.css" rel="stylesheet" type="text/css" />
    <link href="../resources/tpl/zanpiancms/css/style.css" rel="stylesheet" type="text/css" />
    <link href="../resources/tpl/zanpiancms/css/user-white.css" rel="stylesheet" type="text/css" />
    <script src="../resources/tpl/zanpiancms/js/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="../resources/tpl/zanpiancms/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="../resources/tpl/zanpiancms/js/system.js"></script>
    <script type="text/javascript">var cms = {root:"/",public:"/tpl/"};</script>
    <script src="../resources/tpl/zanpianadmin/libs/jquery-cxselect/js/jquery.cxselect.js"></script>
    <link href="../resources/tpl/cms/avatar/cropper.css" rel="stylesheet">
    <script src="../resources/tpl/cms/avatar/cropper.js"></script>
    <link href="../resources/tpl/cms/avatar/avatar.css" rel="stylesheet">
    <style>
        body::-webkit-scrollbar{
            display:none;
        }
    </style>
</head>
<body class="center_body"style="background-image: url(../images/picture/08.jpg);background-size:cover;background-attachment: fixed">
   <nav class="navbar navbar-inverse navbar-fixed-top user-nav" role="navigation">
       <div class="container"><div class="navbar-header navbar-left">
           <div class="navbar-toggle " data-toggle="collapse" data-target="#navbar-collapse">
               <i class="icon iconfont">&#xe641;</i>
           </div>
           <span class="sr-only">切换导航</span>
           <span class="icon-bar"></span>
           <span class="icon-bar"></span>
           <span class="icon-bar"></span>
           </button><a class="navbar-brand" href="/member/">用户中心</a></div>
           <div class="collapse navbar-collapse" id="navbar-collapse">
               <ul class="nav navbar-nav">
                   <li><a href="/user/index">网站首页</a></li>
                   <li class="active"><a href="/user/userCenter">资料</a>
                   <li ><a href="/user/myCollection">我的收藏</a></li>
                   <li ><a href="/member/cm.html">我的评论</a></li>
                   <li ><a href="/member/msg.html">私信</a></li>
                   <li ><a href="/member/gb.html">留言</a></li>
                   <li ><a href="/member/order.html">订单</a></li>
                   <li ><a href="/member/score.html">积分</a></li>

                   <li><a class="loginout" data="/index.php?s=home-ajax-logout-jump-1.html" href="javascript:;" target="_self">退出</a></li></ul></div></div></nav><div class="container  hidden-xs">
       <div class="row">
       <div class="user-box mb20 user-notice">
       <button type="button" class="close user-notice-close">&times;</button>----------可以在会员中心-资料-基本资料-您的昵称下修改为中文昵称，反馈可在留言下发布留言反馈问题！(玛卡巴卡还在赶工中当前页面不是最终效果)----------
       </div>
       </div>
   </div>
          <div class="container">
              <div class="row">
                  <div class="col-md-3 col-sm-4 col-xs-12 box-main-content">
<!--用户信息 -->
                      <div class="user-box clearfix mb20 user-info-left pb-0">
                          <div class="user-center-avatars p-0">
                              <h2 class="text-center p-0 m-0">
                                  <a href="/member/info.html">
                                      <div class="crop avatar">
                                          <img  src="../resources/tpl/zanpianadmin/noavatar_big.gif" id="avatar" align="用户中心" width="150px" height="150px">
                                      </div>
                                  </a>
                              </h2>
                          </div>
                          <div class="user-center-info">
                              <p class="text-center">
                                  <strong class="mr10 text-overflow">葭栖</strong>
                                  <span></span>
                                  <a class="text-color" href="/member/info.html">编辑资料</a></p>
                              <p class="text-muted">
                                  <span>注册时间：</span>2020-11-16 13:30:10</p>
                              <p class="text-muted">
                                  <span>最后登录：</span>2020-11-16 13:30:10</p>
                              <p class="text-muted"><span>登录次数：</span>1 次</p>
                          </div>
                      </div>
<!--最近用户 -->
                      <div class="user-box clearfix  hidden-xs">
                          <div class="user-center-title pt-0 hidden-xs">
                              <h2 class="text-color">最近用户</h2>
                          </div>
                          <ul class="box-star-list clearfix" >
                              <li class="col-md-4 col-sm-4 col-xs-3">
                                  <a class="star-pic img-circle"  style="background: url(../resources/tpl/zanpianadmin/noavatar_big.gif) no-repeat top center;padding-top:100%;background-position:50% 50%;background-size:cover;" href="/u/3296.html">
                                      <span class="text-overflow">葭栖</span>
                                  </a>
                              </li>

                              <li class="col-md-4 col-sm-4 col-xs-3">
                                  <a class="star-pic img-circle"  style="background: url(../images/upload/3175.jpg_middle.jpg) no-repeat top center;padding-top:100%;background-position:50% 50%;background-size:cover;" href="/u/3175.html">
                                      <span class="text-overflow">Chaka</span>
                                  </a>
                              </li>

                          </ul>
                      </div>
                  </div>
                  <div class="col-md-9 col-sm-8 col-xs-12 xs-bt-20 box-main-side"style="height: 700px " >
                      <div class="user-box clearfix"style="background-color: rgba(255,255,255,0.7)">
                          <div class="user-infos">
                              <ul class="nav nav-tabs">
                                  <li class="active"><a href="#tab_1" data-toggle="tab" id="tab-info">基本资料</a></li>
                                  <li><a   href="#tab_3" data-toggle="tab" id="tab-avatar">头像修改</a></li>
                                  <li><a href="#tab_4" data-toggle="tab" id="tab-sns">同步绑定</a></li>
                                  <li><a href="#tab_5" data-toggle="tab" id="tab-pass">密码修改</a></li>
                              </ul>
<!--修改信息-->
                              <div class="tab-pane fade active in" id="tab_1">
                                  <form class="form-horizontal"  id="modifyForm" >
                                      <div class="form-group">
                                          <label for="userName" class="control-label col-xs-12 col-sm-3">您的用户帐号：</label>
                                          <div class="col-xs-12 col-sm-6">
                                              <input type="text" class="form-control" id="userName" name="userName" value="" readonly="readonly" >
                                          </div>
                                      </div>
                                      <div class="form-group">
                                          <label for="tel" class="control-label col-xs-12 col-sm-3">您的手机号</label>
                                          <div class="col-xs-12 col-sm-6">
                                              <input type="text" class="form-control" id="tel" name="tel" value=" ">

                                          </div>
                                      </div>
                                      <div class="form-group">
                                          <label for="email" class="control-label col-xs-12 col-sm-3">您的email地址</label>
                                          <div class="col-xs-12 col-sm-6">
                                              <input type="text" class="form-control" id="email" name="email" value=" " >
                                          </div>
                                      </div>
                                      <div class="form-group">
                                          <label for="address" class="control-label col-xs-12 col-sm-3">您的住址：</label>
                                          <div class="col-xs-12 col-sm-6">
                                              <input type="text" class="form-control" id="address" name="address" value="" >
                                          </div>
                                      </div>
                                      <div class="form-group">
                                          <label for="sex" class="control-label col-xs-12 col-sm-3">性别：</label>
                                          <div class="col-xs-12 col-sm-6">
                                              <select name="sex" id="sex" class="form-control ">
                                                  <option value=" "> </option>
                                                  <option value="男">男</option>
                                                  <option value="女" >女</option></select>
                                          </div>
                                      </div>
                                      <div class="form-group">
                                          <label for="birthday" class="control-label col-xs-12 col-sm-3">出生年月日：</label>
                                          <div class="col-xs-12 col-sm-6">
                                              <input type="date" class="form-control"id="birthday" name="birthday" value="" type="datetime" style="text-align:center">
                                          </div>
                                      </div>
                                      <div class="form-group">
                                          <label for="edu" class="control-label col-xs-12 col-sm-3">学历：</label>
                                          <div class="col-xs-12 col-sm-6">
                                              <select name="edu" id="edu" class="form-control" >
                                                  <option value="">选择学历</option>
                                                  <option value="小学" >小学</option>
                                                  <option value="初中" >初中</option>
                                                  <option value="高中/中专" >高中/中专</option>
                                                  <option value="大专" >大专</option>
                                                  <option value="本科" >本科</option>
                                                  <option value="硕士及以上" >硕士及以上</option>
                                              </select>
                                          </div>
                                      </div>
                                      <div class="form-group">
                                          <label for="industry" class="control-label col-xs-12 col-sm-3">行业：</label>
                                          <div class="col-xs-12 col-sm-6">
                                              <select name="industry" id="industry" class="form-control ">
                                                  <option value="">选择行业</option>
                                                  <option value="教育/学生"   >教育/学生</option>
                                                  <option value="计算机/互联网"  >计算机/互联网</option>
                                                  <option value="建筑"  >建筑</option>
                                                  <option value="金融/房产"  >金融/房产</option>
                                                  <option value="政府/公共服务"  >政府/公共服务</option>
                                                  <option value="电信/网络"  >电信/网络</option>
                                                  <option value="服务"  >服务</option>
                                                  <option value="传媒/娱乐"  >传媒/娱乐</option>
                                                  <option value="农林/化工"  >农林/化工</option>
                                                  <option value="旅游/交通" >旅游/交通</option>
                                                  <option value="其他" >其他</option>
                                              </select>
                                          </div>
                                      </div>
                                      <div class="form-group">
                                          <label for="signature" class="control-label col-xs-12 col-sm-3">个性签名：</label>
                                          <div class="col-xs-12 col-sm-6">
                                              <textarea cols="40" class="form-control txt" name="signature" id="signature" rows="5" placeholder="输入个性签名"></textarea>
                                          </div>
                                      </div>
                                      <div class="form-group">
                                          <label class="control-label col-xs-12 col-sm-3"></label>
                                          <div class="col-xs-12 col-sm-6 text-center">
                                              <button type="button" class="btn btn-success btn-block" id="modifyInfoBtn" from="form-info">提交</button>
                                          </div>
                                      </div>
                                  </form>
                              </div>
<!--修改头像-->
                              <div class="fade visibility" id="tab_3"><a name="#tab_3"></a>
                                  <div class="form-group">
                                      <form class="form-horizontal" id="form-avatar" method="post" role="form"  action="/member/avatar.html" enctype="multipart/form-data" onSubmit="return false;">
                                          <div class="avatar-body">
                                              <div class="avatar-upload">
                                                  <label for="avatarInput" style="line-height:35px; width:auto; margin-right:20px; font-weight:bold">头像上传</label>
                                                  <label class="avatar-input btn btn-primary" for="inputImage" style="float:left">
                                                      <input type="file" class="sr-only" id="inputImage" name="image" accept="image/*">请选择图片</label>
                                                  <input name="x" type="hidden">
                                                  <input name="y" type="hidden">
                                                  <input name="w" type="hidden">
                                                  <input name="h" type="hidden">
                                              </div>
                                              <div class="row ceshi">
                                                  <div class="col-md-9 col-sm-9 col-xs-9">
                                                      <div class="avatar-view">
                                                          <img id="avatar-image" src="">
                                                      </div>
                                                  </div>
                                                  <div class="col-md-3 col-sm-3 col-xs-3" id="preview">
                                                      <div class="avatar-preview avatar-preview-lg"></div>
                                                      <div class="avatar-preview avatar-preview-md"></div>
                                                      <div class="avatar-preview avatar-preview-sm" style="float:right"></div>
                                                  </div>
                                              </div>
                                              <div class="row avatar-tool">
                                                  <div class="col-md-9 col-sm-9 col-xs-9">
                                                      <div class="btn-group">
                                                          <button class="btn btn-primary fa fa-repeat" data-method="rotate" data-option="-45" type="button">右旋</button>
                                                          <button class="btn btn-primary fa fa-repeat" data-method="rotate" data-option="90" type="button">右旋</button>
                                                      </div>
                                                      <div class="btn-group">
                                                          <button class="btn btn-primary fa fa-repeat" data-method="zoom" data-option="0.1" type="button"> 放大</button>
                                                          <button class="btn btn-primary fa fa-repeat" data-method="zoom" data-option="-0.1" type="button"> 缩小</button>
                                                      </div>
                                                      <div class="btn-group">
                                                          <button class="btn btn-primary fa fa-repeat" data-method="move" data-option="-10" data-second-option="0" type="button">左</button>
                                                          <button class="btn btn-primary fa fa-repeat" data-method="move" data-option="10" data-second-option="0"  type="button">右</button>
                                                          <button class="btn btn-primary fa fa-repeat" data-method="move" data-option="0" data-second-option="-10" type="button">上</button>
                                                          <button class="btn btn-primary fa fa-repeat" data-method="move" data-option="0" data-second-option="10" type="button">下</button>
                                                      </div>
                                                      <div class="btn-group">
                                                          <button class="btn btn-primary fa fa-repeat" data-method="scaleX" data-option="-1" type="button">左右</button>
                                                          <button class="btn btn-primary fa fa-repeat" data-method="scaleY" data-option="-1" type="button">上下</button>
                                                      </div>
                                                  </div>
                                                  <div class="col-md-3 col-sm-3 col-xs-3">
                                                      <button type="button" class="btn btn-success btn-block" id="submit-avatar">保存</button>
                                                  </div>
                                              </div>
                                          </div>
                                      </form>
                                  </div>
                              </div>
<!--绑定账号 -->
                              <div class="tab-pane fade" id="tab_4">
                                  <div class="col-md-12 sns-list">
                                      <div class="col-md-2 col-sm-2 col-xs-12">
                                          <div class="login-ico">
                                              <a rel="nofollow" class="qq text-center">
                                                  <i class="icon iconfont">&#xe73e;</i></a>
                                          </div>
                                      </div>
                                      <div class="col-md-8 col-sm-8 col-xs-12">
                                          <strong>腾讯QQ</strong>
                                          <span>绑定腾讯QQ帐号后，您便可使用腾讯QQ帐号登录网站</span>
                                      </div>
                                      <div class="col-md-2 col-sm-2 col-xs-12 text-center">
                                          <a class="btn btn-success" id="delsns" data-id="qq" style="display:none">取消绑定</a>
                                          <a class="btn btn-default"  href="#" target="_self" >立即绑定</a>
                                      </div>
                                  </div>
                                  <div class="col-md-12 sns-list">
                                      <div class="col-md-2 col-sm-2 col-xs-12">
                                          <div class="login-ico">
                                              <a rel="nofollow" class="weixin text-center">
                                                  <i class="icon iconfont">&#xe73c;</i>
                                              </a>
                                          </div>
                                      </div>
                                      <div class="col-md-8 col-sm-8 col-xs-12">
                                          <strong>微信</strong>
                                          <span>绑定微信后，您便可使用微信扫码登录网站</span>
                                      </div>
                                      <div class="col-md-2 col-sm-2 col-xs-12 text-center">
                                          <a class="btn btn-success" id="delsns" data-id="weiqrcode" style="display:none">取消绑定</a>
                                          <a class="btn btn-default" href="#" target="_self" >立即绑定</a>
                                      </div>
                                  </div>
                                  <div class="col-md-12 sns-list">
                                      <div class="col-md-2 col-sm-2 col-xs-12">
                                          <div class="login-ico">
                                              <a rel="nofollow" class="weibo text-center">
                                                  <i class="icon iconfont">&#xe73c;</i>
                                              </a>
                                          </div>
                                      </div>
                                      <div class="col-md-8 col-sm-8 col-xs-12">
                                          <strong>新浪微博</strong>
                                          <span>绑定新浪微博帐号后，您便可使用新浪微博帐号登录网站</span>
                                      </div>
                                      <div class="col-md-2 col-sm-2 col-xs-12 text-center">
                                          <a class="btn btn-success" id="delsns" data-id="weibo" style="display:none">取消绑定</a>
                                          <a class="btn btn-default" href="#" target="_self" >立即绑定</a>
                                      </div>
                                  </div>
                              </div>
<!--修改密码 -->
                              <div class="tab-pane fade" id="tab_5">
                                  <form class="form-horizontal"  >
                                      <div class="form-group">
                                          <label for="oldPassword" class="control-label col-xs-12 col-sm-3">原密码：</label>
                                          <div class="col-xs-12 col-sm-6">
                                              <input class="form-control" id="oldPassword" name="oldPassword" type="password" placeholder="您的密码" required>
                                          </div>
                                      </div>
                                      <div class="form-group">
                                          <label for="newPassword" class="control-label col-xs-12 col-sm-3">新密码：</label>
                                          <div class="col-xs-12 col-sm-6">
                                              <input class="form-control" id="newPassword" name="newPassword" type="password" placeholder="新密码" required>
                                          </div>
                                      </div>
                                      <div class="form-group">
                                          <label for="confirmPassword" class="control-label col-xs-12 col-sm-3">确认密码：</label>
                                          <div class="col-xs-12 col-sm-6">
                                              <input class="form-control" id="confirmPassword" name="confirmPassword" type="password" placeholder="新密码" required>
                                          </div>
                                      </div>
                                      <div class="form-group">
                                          <label class="control-label col-xs-12 col-sm-3"></label>
                                          <div class="col-xs-12 col-sm-6 text-center">
                                              <button type="button" class="btn btn-success btn-block" id="updateBtn">提交</button>
                                          </div>
                                      </div>
                                  </form>
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
   <script type="text/javascript">var console = window.console || { log: function () {} };
var $image = $("#avatar-image");
// 获取裁切时的四个框
var x = $("input[name=x]");
var y = $("input[name=y]");
var w = $("input[name=w]");
var h = $("input[name=h]");
//选择图片时预览图片 并 调用cropper插件
$("input[type=file]").change(function() {
	// 先消毁，清除一下插件，否则连续调用插件时会失败
	$image.cropper("destroy");
	// this.files[0]：获取当前图片并转成URL地址
	var url = getObjectUrl(this.files[0]);
	console.log(url)
	$image.attr('src', url);// 设置url到预览图片上
	// 调出插件
	$image.cropper({
		// 裁切的框形状
		aspectRatio: 1/1,
		 // 显示预览的位置
		preview:'.avatar-preview',
		// 显示模式：图片不能无限缩小，但可以放大
		viewMode: 1,
		// 裁切时把参数保存到表单中
		crop: function(event) {
			x.val(event.detail.x);
			y.val(event.detail.y);
			w.val(event.detail.width);
			h.val(event.detail.height);
			w.val(event.detail.width);
		}
	});
});
// 预览时需要使用下面这个函数转换一下
function getObjectUrl(file) {
	var url = null;
	if (window.createObjectURL != undefined) {
		url = window.createObjectURL(file)
	} else if (window.URL != undefined) {
		url = window.URL.createObjectURL(file)
	} else if (window.webkitURL != undefined) {
		url = window.webkitURL.createObjectURL(file)
	}
	return url
}
// Methods
$('.avatar-tool').on('click', '[data-method]', function() {
	var $this = $(this);
	var data = $this.data();
	var cropper = $image.data('cropper');
	var cropped;
	var $target;
	var result;
	if ($this.prop('disabled') || $this.hasClass('disabled')) {
		return;
	}
	if (cropper && data.method) {
		data = $.extend({}, data); // Clone a new one
		if (typeof data.target !== 'undefined') {
			$target = $(data.target);
			if (typeof data.option === 'undefined') {
				try {
					data.option = JSON.parse($target.val());
				} catch (e) {
					console.log(e.message);
				}
			}
		}
		cropped = cropper.cropped;
		switch (data.method) {
		case 'rotate':
			if (cropped) {
				$image.cropper('clear');
			}
			break;
		case 'getCroppedCanvas':
			if (uploadedImageType === 'image/jpeg') {
				if (!data.option) {
					data.option = {};
				}
				data.option.fillColor = '#fff';
			}
			break;
		}
		result = $image.cropper(data.method, data.option, data.secondOption);
		switch (data.method) {
		case 'rotate':
			if (cropped) {
				$image.cropper('crop');
			}
			break;
		case 'scaleX':
		case 'scaleY':
			$(this).data('option', -data.option);
			break;
		case 'getCroppedCanvas':
			if (result) {
				// Bootstrap's Modal
				$('#getCroppedCanvasModal').modal().find('.modal-body').html(result);

				if (!$download.hasClass('disabled')) {
					download.download = uploadedImageName;
					$download.attr('href', result.toDataURL(uploadedImageType));
				}
			}
			break;
		case 'destroy':
			if (uploadedImageURL) {
				URL.revokeObjectURL(uploadedImageURL);
				uploadedImageURL = '';
				$image.attr('src', originalImageURL);
			}
			break;
		}
		if ($.isPlainObject(result) && $target) {
			try {
				$target.val(JSON.stringify(result));
			} catch (e) {
				console.log(e.message);
			}
		}
	}
});
$("#submit-avatar").click(function(e) {
	var $imgData = $image.cropper('getCroppedCanvas');
	var dataurl = $imgData.toDataURL('image/jpg');
	var blob = dataURLtoBlob(dataurl);
	var form = document.querySelector("#form-avatar");
	var formData = new FormData(form);
	formData.append("file", blob);

	$.ajax({
		url: '/user/toUpload',
		type: 'post',
		dataType: 'json',
		data: formData,
		cache: false,
		processData: false,
		contentType: false,
		success: function(r) {
		    if(r.state==201){
                alert(r.msg,function () {
                    //重新登录
                    location.href="/user/log";
                });
            }
		    if (r.state==200){
		        alert(r.msg,function () {
		            window.location.href="/user/userCenter"

                })
            }
	if (r.state==1){
	    alert(r.msg);
    }


		},
		error: function() {
		alert(r.msg);
		},
	});
return false;
});
//将base64格式图片转换为文件形式
function dataURLtoBlob(dataurl) {
	var arr = dataurl.split(','),
		mime = arr[0].match(/:(.*?);/)[1],
		bstr = atob(arr[1]),
		n = bstr.length,
		u8arr = new Uint8Array(n);
	while (n--) {
		u8arr[n] = bstr.charCodeAt(n);
	}
	return new Blob([u8arr], {
		type: mime
	});
}
$(function () {
	 $(".avatar-view").height($('#preview').height()-25);
	$(window).resize(function() {
       $(".avatar-view").height($('#preview').height()-25);
    });
});
$(".nav-tabs li a").click(function() {
	$('#tab_3').removeClass("visibility");
	$('#tab_3').addClass("tab-pane");

});
</script>﻿
</body>
<script src="https://cdn.jsdelivr.net/npm/jutils-src"></script>
<!--根据用户名查询用户-->
<script>
    //页面加载完成后加载数据
    //$(document).ready();
    //$(function(){})
    $.get("../user/findUserInfo",function (data) {
        var birthday = jutils.formatDate(new Date(data.birthday),"yyyy-MM-dd");
        console.log(birthday);
//将用户名显示到输入框
        $("#userName").val(data.userName);
        $("#tel").val(data.tel);
        $("#email").val(data.email);
        $("#address").val(data.address);
        $("#sex").val(data.sex);
      if (data.birthday!=null){
          var birthday = jutils.formatDate(new Date(data.birthday),"yyyy-MM-dd");
          console.log(birthday);
          $("#birthday").val(birthday);
      }
        $("#edu").val(data.edu);
        $("#industry").val(data.industry);
        $("#signature").val(data.signature);
    });

    $("#modifyInfoBtn").click(function () {
        //获取表单信息
        var data=$("#modifyForm").serialize();
         $.post("/user/modifyUserInfoByUsername",data,function (data) {
          if (data.state==201){
            alert(data.msg,function () {
                //重新登录
                location.href="/user/log";
             })
             }else{
         alert(data.msg,function () {
             window.location.reload(true);
         })
         }
         })

    })


</script>

<!--修改密码-->
<script>
    //给修改按钮添加点击事件
    $("#updateBtn").click(function () {
        //获取三个密码
        var oldPassword = $("#oldPassword").val();
        var newPassword = $("#newPassword").val();
        var confirmPassword = $("#confirmPassword").val();
        //发送Ajax
        $.post("/user/toUpdatePwd",{"oldPassword":oldPassword,"newPassword":newPassword,"confirmPassword":confirmPassword},
            function (data) {
            if (data.state==200){
                alert(data.msg,function () {
                    //重新登录
                    location.href="/user/log";
                });

            }else {
                alert(data.msg);
            }


        })
    })
</script>
<!--&lt;!&ndash;头像上传&ndash;&gt;-->
<!--<script>-->
<!--  $("#save").click(function () {-->
<!--      var dataForm=$("#upload")[0];-->
<!--      var data=new FormData(dataForm);-->
<!--      // 如果使用Ajax实现文件上传,必须添加两个属性-->
<!--      $.Ajax{}-->



<!--  })-->
<!--</script>-->

<!--自定义弹框-->
<script>
    window.alert = alert;
    function alert(data, callback) { //回调函数
        var alert_bg = document.createElement('div');
        alert_box = document.createElement('div'),
            alert_text = document.createElement('div'),
            alert_btn = document.createElement('button'),
            textNode = document.createTextNode(data ? data : ''),
            btnText = document.createTextNode('明白啦!');

        // 控制样式
        css(alert_bg, {
            'position': 'fixed',
            'top': '187px',
            'left': '880px',
            'right': '520px',
            'bottom': '617px',
            'background-color': 'rgba(0, 0, 0, 0.5)',
            'z-index': '999999999',

            'background-image':'url(../images/picture/07.jpg)',
            // 'background-size':'550px,250px',
            // 'background-position':'center',
            'background-size':'cover',
            // 'border-bottom-left-radius':'80px',
            // 'border-top-left-radius':'10px',


        });

        css(alert_box, {
            'height':'70px',
            'width': '100%',
            'max-width': '100%',
            'font-size': '28px',
            'text-align': 'center',
            'background-color': 'rgba(100,100,200,0.7)',
            // 'border-bottom-left-radius': '43px',
            'position': 'absolute',
            'top': '40%',
            'left': '49.7%',
            'transform': 'translate(-50%, -50%)',
            // 'font-family':'RuiHei Bauhaus Kr',
            'font-weight':'bold',
            'font-family':'宋体',
            'background-size':'500px,500px',
            'background-position':'center',


        });

        css(alert_text, {
            'padding': '20px 15px',

            'color': 'rgba(80,250,250,1)',
        });

        css(alert_btn, {
            'padding': '8px 7px',
            'color': 'rgba(255,255,255,0.9)',
            'font-weight': '600',
            'cursor': 'pointer',
            'background-color': 'rgba(255,170,10,0.7)',
            'border-radius': '20%',
            'height':'45px',
            'width': '110px',
            'margin-top':'15px',
            'font-family':'RuiHei Bauhaus Kr',
            'font-size': '23px',
            'margin-left':'305px',

        });

        // 内部结构套入
        alert_text.appendChild(textNode);
        alert_btn.appendChild(btnText);
        alert_box.appendChild(alert_text);
        alert_box.appendChild(alert_btn);
        alert_bg.appendChild(alert_box);

        // 整体显示到页面内
        document.getElementsByTagName('body')[0].appendChild(alert_bg);

        // 确定绑定点击事件删除标签
        alert_btn.onclick = function() {
            alert_bg.parentNode.removeChild(alert_bg);
            if (typeof callback =='function') {
                callback(); //回调
            }
        }
    }

    function css(targetObj, cssObj) {
        var str = targetObj.getAttribute("style") ? targetObj.getAttribute('style') : '';
        for (var i in cssObj) {
            str += i + ':' + cssObj[i] + ';';
        }
        targetObj.style.cssText = str;
    }


</script>
</html>